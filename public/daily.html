<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily overview</title>
    <link rel="stylesheet" type="text/css" href="/styles/daily.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<!-- CORPO DO CÓDIGO -->
<body>
    <!-- CONTAINER PRINCIPAL (Abrange tudo da página dentro dele) -->
    <div class="container-principal">

        <!-- Primeira linha (título) -->
        <div class="row letter" id="row-dPerformance">
            <label for="">Daily Performance Insights</label>
        </div>

        <!-- Linha de espaçamento -->
        <div class="row"></div>
        
        <!-- Linha "November 2024" -->
        <div class="row letter" id="row-nov24">
            <label for="">November 2024</label>
        </div>
 
        <!-- Container dos botões dos dias da semana -->
        <div class="container-buttons">  
            <button class="button-day">01<br><div class="names-buttons-day">Mon</div></button>
            
            <button class="button-day">02<br><div class="names-buttons-day">Tue</div></button>
            
            <button class="button-day">03<br><div class="names-buttons-day">Wed</div></button>
            
            <button class="button-day">04<br><div class="names-buttons-day">Thu</div></button>
            
            <button class="button-day">05<br><div class="names-buttons-day">Fri</div></button>
        </div>
        
        <!-- Container que mostra o dia da semana selecionado -->
        <div class="container" id="container-day-show">
            <div class="row text-container-day-show">
                <input type="text" class="input-c-day-show" value="DY1A" disabled>
            </div>
        </div>

        <!-- Linha do "Performance Insights" -->
        <div class="row g-0 letter more-letter-size" id="row-true-insights"> 
            <label for="">Performance Insights</label>
        </div>

        <!-- CONTAINER DOS PRIMEIROS INSIGHTS -->
        <div class="container-insights"> 

            <!-- Divisória da primeira linha do container -->
            <div class="div-container-insights-1">

                <!-- Linha interna -->
                <div class="row container-inside-c-insights">
                    <!-- BUTTONS -->
                    <div class="col-6 pe-0"> 
                        <button class="buttons-insights button-esquerdo-row-inside">
                            <label class="names-buttons-insights name-button-SPR">SPR</label>
                            <br>
                            <input type="text" value="((dailyMetrics.totalStops))" disabled>
                        </button>
                    </div>
                    
                    <div class="col-6 ps-0">
                        <button class="buttons-insights button-direito-row-inside">
                            <label class="names-buttons-insights name-button-SPORH">SPORH</label>
                            <br>
                            <input class="input-SPORH" type="text" value="((dailyMetrics.sporh))%" disabled>
                        </button>
                    </div>
                    <!-- // -->
                </div>
            </div>
            
            <!-- Espaçamento das linhas -->
            <div class="space-divs"></div>

            <!-- Divisória da segunda linha do container -->
            <div class="div-container-insights-2">

                <!-- Linha interna -->
                <div class="row container-inside-c-insights">

                    <!-- BUTTONS -->
                    <div class="col-6 pe-0"> 
                        <button class="buttons-insights button-esquerdo-row-inside">
                            <label class="names-buttons-insights name-button-TW">TW</label>
                            <br>
                            <input class="input-TW" type="text" value="((timeWindows.percentageOnTime))%" disabled>
                        </button>
                    </div>
                    
                    <div class="col-6 ps-0">
                        <button class="buttons-insights button-direito-row-inside">
                            <label class="names-buttons-insights name-button-AFD">AFD</label>
                            <br>
                            <input type="text" value="((deliveryDetails.totalAfd))%" disabled>
                        </button>
                    </div>
                    <!-- // -->
                </div>
            </div>

            <!-- Espaçamento das linhas -->
            <div class="space-divs"></div>

             <!-- Divisória da terceira linha do container -->
            <div class="div-container-insights-3">

                <!-- Linha interna -->
                <div class="row container-inside-c-insights">

                    <!-- BUTTONS -->
                    <div class="col-4 pe-0"> 
                        <button class="buttons-insights button-esquerdo-row-inside">
                            <label class="names-buttons-insights name-button-Departed">Departed</label>
                            <br>
                            <input type="text" value="((deliveryDetails.departTime))" disabled>
                        </button>
                    </div>

                    <div class="col-4 ps-0 pe-0">
                        <button class="buttons-insights button-meio-row-inside">
                            <label class="names-buttons-insights name-button-Arrived">Arrived</label>
                            <br>
                            <input type="text" value="((deliveryDetails.arriveTime))" disabled>
                        </button>
                    </div>
                    
                    <div class="col-4 ps-0 pe-1">
                        <button class="buttons-insights button-direito-row-inside">
                            <div class="scale-buttons">
                                <label class="names-buttons-insights name-button-Break">Break</label>
                                <br>
                                <div class="div-break">
                                    <div class="col-break1">
                                        <input class="input-break" type="text" value="((dailyMetrics.breakMinutes))" disabled>
                                    </div>

                                    <div class="space-cols"></div>

                                    <div class="col-break2">
                                        <label class="names-buttons-insights" id="min" for="">Min</label>
                                    </div>
                                </div>
                            </div>
                        </button>
                    </div>
                    <!-- // -->
                </div>
            </div>
        </div>
        
        <!-- Linha da label "SUCCESSFUL STOPS" -->
        <div class="row letter more-letter-size">
            <label for="">SUCCESSFUL STOPS</label>
        </div>
        
        <!-- CONTAINER DOS "Successful Stops" -->
        <div class="container container-stops">

            <!-- Divisória da primeira linha do container -->
            <div class="div-container-stops-1">

                <!-- Linha interna -->
                <div class="row container-inside-c-stops">

                    <!-- BUTTONS -->
                    <div class="col-3 pe-0"> 
                        <button class="buttons-stops">
                            <label class="names-buttons-stops name-button-PU">PU</label>
                            <br>
                            <input type="text" value="((deliveryDetails.paidStops.pu))" disabled>
                        </button>
                    </div>

                    <div class="col-3 pe-0 ps-0"> 
                        <button class="buttons-stops">
                            <label class="names-buttons-stops name-button-Ok">Ok</label>
                            <br>
                            <input type="text" value="((deliveryDetails.paidStops.ok))" disabled>
                        </button>
                    </div>
                    
                    <div class="col-3 ps-0 pe-0">
                        <button class="buttons-stops button-direito-row-inside">
                            <label class="names-buttons-stops name-button-HN">HN</label>
                            <br>
                            <input type="text" value="((deliveryDetails.paidStops.hn))" disabled>
                        </button>
                    </div>

                    <!-- Button cortado ao meio -->
                    <div class="col-3 pe-0 ps-0"> 
                        <button class="buttons-stops button-stops-PD">
                            <label class="names-buttons-stops name-button-PD">PD</label>
                            <input class="input-half" value="((deliveryDetails.paidStops.pd))" disabled>
                        </button>
                    </div>
                    <!-- // -->
                </div>
            </div>
        </div>
        
        <!-- Linha da label "ATTEMPED FAILED DELIVERIES" -->
        <div class="row letter more-letter-size">
            <label for="">ATTEMPED FAILED DELIVERIES</label>
        </div>

        <!-- CONTAINER DOS "Failed Deliveries" -->
        <div class="container container-failed-deliveries">

            <!-- Divisória da primeira linha do container -->
            <div class="div-container-fdeliveries-1">
                <!-- Linha interna -->
                <div class="row container-inside-c-fdeliveries">

                    <!-- BUTTONS -->
                    <div class="col-4 pe-0"> 
                        <button class="buttons-fdeliveries">
                            <label class="names-buttons-fdeliveries name-button-NR">NR</label>
                            <br>
                            <input type="text" value="((deliveryDetails.unpaidStops.nr))" disabled>
                        </button>
                    </div>

                    <div class="col-4 pe-0 ps-0"> 
                        <button class="buttons-fdeliveries">
                            <label class="names-buttons-fdeliveries name-button-FP">FP</label>
                            <br>
                            <input type="text" value="((deliveryDetails.unpaidStops.fp))" disabled>
                        </button>
                    </div>
                    
                    <!-- Button cortado ao meio -->
                    <div class="col-4 pe-0 ps-0">
                        <button class="buttons-fdeliveries button-fdeliveries-RD">
                            <label class="names-buttons-fdeliveries name-button-RD">RD</label>
                            <br>
                            <input class="input-half" value="((deliveryDetails.unpaidStops.rd ))" disabled>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Espaçamento das linhas -->
            <div class="space-divs-fdeliveries"></div>

            <!-- Divisória da segunda linha do container -->
            <div class="div-container-fdeliveries-2">

                <!-- Linha interna -->
                <div class="row container-inside-c-fdeliveries">

                    <!-- BUTTONS -->
                    <div class="col-4 pe-0"> 
                        <button class="buttons-fdeliveries">
                            <label class="names-buttons-fdeliveries name-button-BA">BA</label>
                            <br>
                            <input type="text" value="((deliveryDetails.unpaidStops.ba))" disabled>
                        </button>
                    </div>
                    
                    <div class="col-4 ps-0 pe-0">
                        <button class="buttons-fdeliveries">
                            <label class="names-buttons-fdeliveries name-button-AFD">NH</label>
                            <br>
                            <input type="text" value="((deliveryDetails.unpaidStops.nh))" disabled>
                        </button>
                    </div>

                    <div class="col-4 ps-0 pe-0">
                        <button class="buttons-fdeliveries">
                            <label class="names-buttons-fdeliveries name-button-CM">CM</label>
                            <br>
                            <input type="text" value="((deliveryDetails.unpaidStops.cm))" disabled>
                        </button>
                    </div>
                    <!-- // -->
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

<script>
    // Busca os dados da SUA API (que retorna JSON)
    fetch('/api/bff/day-overview')
        .then(response => {
            if (!response.ok) {
                return response.text().then(text => {
                throw new Error(`Erro ${response.status}: ${text}`);
                });
            }
            return response.json();
            })
        .then(data => {
        // Função para substituir ((chave)) pelos valores
        const replacePlaceholders = (text, obj) => {
            return text.replace(/\(\((\w+\.?[\w\.]*)\)\)/g, (match, key) => {
            const keys = key.split('.');
            return keys.reduce((acc, curr) => acc?.[curr], obj) || match;
            });
        };

        // Atualiza todos os inputs com os valores
        document.querySelectorAll('input').forEach(input => {
            input.value = replacePlaceholders(input.value, data);
        });
        })
        .catch(error => {
        console.error('Erro:', error);
        alert('Não foi possível carregar os dados.');
        });
  </script>

</html>